var map=L.map("map").setView([25.0744,121.5514],11);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'<a href="https://www.openstreetmap.org/">OSM</a>',maxZoom:18}).addTo(map);var marker=L.marker();function setMapMarker(t,e){marker.setLatLng([t,e]).addTo(map)}function MapMarkerClear(){map.removeLayer(marker)}var popup=L.popup();function onMapClick(t){popup.setLatLng(t.latlng).setContent("這裡是"+t.latlng.toString()).openOn(map)}map.on("click",onMapClick);const ListInfo=document.getElementById("info"),spreadsheet_id="1NXWNLxCflYBSmBDDwhn6Ij2itmT3kF2QjjevNbeZ9bo",tab_name="工作表1",api_key="AIzaSyAMpJ-FWW1qt2uH7auDxkPrXc_hkbg9fKw";var dataurl=`https://sheets.googleapis.com/v4/spreadsheets/${spreadsheet_id}/values/工作表1?key=${api_key}`;function getgoogleData(){return axios.get(dataurl)}var liInfos=[];function ShowData(t){t.values.shift(),t.values.forEach((function(t){const e=document.createElement("li");e.setAttribute("class","item d-flex shadow-sm border mb-2 px-3 py-2 rounded-4");const n=document.createElement("span");if(n.setAttribute("class","d-block col-4 col-md-3 col-lg-3 pe-3"),void 0!==t[4]){const e=document.createElement("img");e.setAttribute("src",t[4]),e.setAttribute("class","img-fluid"),n.appendChild(e)}e.appendChild(n);const a=document.createElement("span");if(a.setAttribute("class","d-block col-8 col-md-9 col-lg-9"),""!==t[5]){const e=document.createElement("a");e.setAttribute("class","float-end top-0 text-mb-small d-inline-block text-decoration-none"),e.setAttribute("href",t[5]),e.setAttribute("target","_blank"),e.setAttribute("title",t[2]+"官方網站或活動專網(另開新視窗)");const n=document.createTextNode("官網"),o=document.createElement("span");o.setAttribute("class","material-symbols-outlined align-text-bottom small"),o.setAttribute("aria-hidden","true");const s=document.createTextNode("open_in_new");o.appendChild(s),e.appendChild(o),e.appendChild(n),a.appendChild(e)}const o=document.createElement("strong");o.setAttribute("class","title d-block fw-bold pt-2");const s=document.createTextNode(t[2]);o.appendChild(s),a.appendChild(o);const i=document.createElement("span");if(""==t[1]){const e=document.createTextNode(`${t[0]}`);i.setAttribute("class","time-txt"),i.appendChild(e)}else{const e=document.createTextNode(`${t[0]} 至 ${t[1]}`);i.setAttribute("class","time-txt"),i.appendChild(e)}const d=document.createElement("br");a.appendChild(i),a.appendChild(d);let l=t[7];if(""!==l){const e=document.createElement("a");e.setAttribute("class","text-mb-small d-inline-block pt-2 text-decoration-none me-2"),e.setAttribute("href","https://www.google.com/maps/search/"+l),e.setAttribute("target","_blank");const n=document.createElement("span");n.setAttribute("class","material-symbols-outlined align-text-bottom small"),n.setAttribute("aria-hidden","true");const o=document.createTextNode("map"),s=document.createElement("span"),i=document.createTextNode(t[6]);n.appendChild(o),s.appendChild(n),s.appendChild(i),e.appendChild(s),a.appendChild(e)}if(void 0!==t[3]){const e=document.createElement("span");e.setAttribute("class","info-txt text-mb-small d-block small text-secondary");const n=document.createTextNode(t[3]);e.appendChild(n),a.appendChild(e);document.querySelectorAll(".info-txt").forEach((function(t){if(t.textContent.length>50){t.setAttribute("title",t.textContent);var e=t.textContent.substring(0,49)+"...";t.textContent=e}}));let o=Math.round(window.innerHeight)-Math.round(ListInfo.getBoundingClientRect().top)-16;document.querySelector(".container-md").setAttribute("data-height",o)}e.appendChild(a),ListInfo.appendChild(e),void 0!==t[8]||void 0!==t[9]?(e.addEventListener("mouseenter",(function(){setMapMarker(t[8],t[9]),map.setView([t[8],t[9]],17)})),e.addEventListener("click",(function(){setMapMarker(t[8],t[9]),map.setView([t[8],t[9]],17)}))):e.addEventListener("mouseenter",(function(){MapMarkerClear(),map.setView([25.0744,121.5514],11)}))}))}Promise.all([getgoogleData()]).then((function(t){ShowData(t[0].data)})).catch((t=>{}));